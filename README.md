# Visual-Vers



#### 简介

Visual-Vers是一款可视化的版本控制软件，目的在于补全git在可视化方面的不足，让版本控制工具大众化。

它比git更简单，更容易上手，更能用图像界面形象展示版本关系，能帮助新人更好的入门版本控制。

目前百度上能找到的大多git可视化工具，都和git desktop差不多，只是显示了节点信息或是做了差异对比，而没有显示各个版本节点、分支之间的继承推进关系。而本项目则完成了这一任务。



#### 功能

本项目实现了git的大部分基础功能，包括：

- 版本记录
- 版本回滚
- 分支操作
- 版本合并
- 版本差异对比
- 文件变更对比

另外实现了git不具备的图形界面：

- 版本继承关系图显示
- 提交用户、提交时间、评论记录显示

因时间和技术原因，git远程仓库服务端没能完成，但本项目**具备实现分布式的可拓展性**，将在接下来说明。





#### 原理简介

###### 文件系统

版本控制实际上一个文件系统，其中总的来看有两个树形结构。每个版本都是一棵文件树，文件树的根节点又构成了一棵版本继承树（因为版本合并操作的存在，版本继承树准确来说是一个DAG（有向无环图））

一个版本对应一个文件树，叶子节点对应文件（FileNode），其他节点对应文件夹（TreeNode），同时也是一棵独立的文件树。根节点则对应这一整个版本（CommitNode）。两个版本的文件树可以共用一些节点，做到节省空间，总结构类似可持久化线段树。

###### 项目变更发现

这里指在整个工作区中，找到所有用户修改过的文件（相对于上个版本）并罗列呈现，和下面的“文件变更发现”有所区别。

文件树中的每个节点都有一个哈希值，利用此哈希值可以快速判断两个节点是否相同。

git也是依赖哈希判断文件是否相同的，但它只关注文件内容，将文件名放置在TreeNode（即保存它的文件夹）中，而本项目则将文件内容和文件名称放在一起去获取哈希值，这样做的优势在于：git判断两个节点是否相同必须依赖上下文，而本项目具体存储的节点完全是“路径无关”的，可以做到散列存储。

###### 文件变更发现

这里指的是对某个具体的文件，找出其修改内容（具体增删了哪些字符）

对应git当中的git diff功能，它的抽象问题是求两个字符串之间的最小编辑次数，将删除和插入视作一次编辑，修改视作删除+插入。

求变更方案的第一原则是编辑次数最小，它可以通过求最长公共子序列完成，复杂度为 $O(n^2)$，更优的解法是myers算法，同样为动态规划解法，复杂度为$O(nd)$，d为修改次数。本项目使用myers完成。

参考资料：https://zhuanlan.zhihu.com/p/67024353

###### 有向图绘制





#### 物理结构
